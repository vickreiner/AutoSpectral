<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cleaning • AutoSpectral</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cleaning">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AutoSpectral</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Aurora_example.html">Aurora_example</a>
    </li>
    <li>
      <a href="../articles/Cleaning.html">Cleaning</a>
    </li>
    <li>
      <a href="../articles/Control_File_example.html">Control_File_example</a>
    </li>
    <li>
      <a href="../articles/Development.html">Development</a>
    </li>
    <li>
      <a href="../articles/Full_AutoSpectral_Workflow.html">Full Workflow Example</a>
    </li>
    <li>
      <a href="../articles/Gating.html">Gating</a>
    </li>
    <li>
      <a href="../articles/Per_Cell_Optimization.html">Per Cell Optimization</a>
    </li>
    <li>
      <a href="../articles/Plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/Reload_AutoSpectral.html">Re-running_AutoSpectral</a>
    </li>
    <li>
      <a href="../articles/Single_Cell_AutoFluorescence.html">Single Cell Autofluorescence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DrCytometer/AutoSpectral/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cleaning</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DrCytometer/AutoSpectral/blob/HEAD/vignettes/articles/Cleaning.Rmd" class="external-link"><code>vignettes/articles/Cleaning.Rmd</code></a></small>
      <div class="hidden name"><code>Cleaning.Rmd</code></div>

    </div>

    
    
<p>In this article, we’ll try to cover the functions that AutoSpectral
offers for cleaning your single-stained control data.</p>
<p>If you want to follow along with this, you can download the data for
this set from Mendeley Data. Alternatively, adapt it to your own
samples. <a href="https://data.mendeley.com/datasets/y2zp5xx2hg/2" class="external-link uri">https://data.mendeley.com/datasets/y2zp5xx2hg/2</a></p>
<p>First off, what do we mean by “cleaning”? When we use single-stained
cells, they are never really single colour controls. There’s always
autofluoresences. This is true for beads in a way–they have
background–however with beads, the background is homogeneous
(hopefully), whereas with cells we are almost always working with a
heterogenous mixtures. That means some cells are more autofluorescent
than others, and we can get some cells popping up as “positive” in your
data for the fluorophores. AutoSpectral provides some tools to help
reduce the influence of these problems, aiming to give you cleaner
spectra. Cleaner spectra should lead to more accurate, more precise and
more reproducible unmixing.</p>
<p>Right, so there are four cleaning options in AutoSpectral:</p>
<ol style="list-style-type: decimal">
<li><p>Trimming. Trimming removes extreme events, usually the top and
bottome 0.5%. This was implemented in the original AutoSpill where
detector noise was more of an issue. We don’t generally want to use this
with spectral data where we have low-noise detectors because it would
remove the brightest (and most accurate) events. If you have an issue
with aggregates in your single-colour controls (which can happen with
nanoparticles, old antibodies and NovaFluors), you can try the trimming.
We’re not going to cover it in this article.</p></li>
<li><p>Time-based cleaning. We do this with our fully stained data
through tools like flowClean, flowAI and PeacoQC. This removes
inconsistencies in the flow, which are less accurate. AutoSpectral
employs PeacoQC with the “MAD” (robust standard deviation) method to
clean controls, if you activate this option. By default, it’s off. This
is because it’s fairly slow and time-based variability shouldn’t really
be an issue unless you’re doing things like running unfiltered cells on
a high flow rate. If you are, try time.clean.</p></li>
<li><p>AF exclusion. For this, we need matching unstained samples.
AutoSpectral identifies populations of cells with high variance and
signal in the unstained sample, and creates a gate around the main
trajectory of these cells. It does this by figuring out where the
autofluorescent cells are in the unstained and drawing the gate on the
main signal of the annoying cells relative to where we expect to see the
fluorophore for each control. Cells in the gate are then excluded from
the single-stained controls for the purpose of calculating the spectral
signatures of the fluorophores. This is off by default because it’s a
bit slow at present. It’s not likely to be necessary if you’re running
PBMCs or staining other low-AF populations like lymph nodes. Once you
get macrophages in the mix (e.g., splenocytes), this can definitely
help. AF exclusion is never performed on beads.</p></li>
<li><p>Matching negatives. Again, we need matching unstained samples
(universal negatives). Here, we’re trying to match the background of the
unstained and stained cells as closely as possible. For instance, if we
are staining a T cell marker, the correct background to subtract is that
of T cells. For a macrophage marker, we want to subtract the background
given by unstained macrophages. While we can’t do that perfectly without
sorting a whole bunch of different cell types (which wouldn’t work
anyway due to changes in cells due to handling), we can do better than
just using all the rest of the cells (the internal negative population).
If we take the matching unstained sample, we can locate cells that have
similar forward (FSC) and side scatter (SSC) profiles, and use these as
the negative. This works pretty well as long as your negatives and
positives have been treated identically and have been run on the same
instrument settings.</p></li>
</ol>
<p>By default, <code>clean.controls</code> downsamples the data,
selecting the <code>500</code> brightest events in the peak channel for
each fluorophore’s control. The brightest events are almost always the
most accurate, and this speeds up the calculations a great deal. Better
results, faster.</p>
<p>Right, let’s go over some data as an example.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://github.com/DrCytometer/AutoSpectral" class="external-link">AutoSpectral</a></span> <span class="op">)</span></span></code></pre></div>
<p>We need to set up our experiment. This is Aurora data. See the
control file and gating articles for more info.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.autospectral.param.html">get.autospectral.param</a></span><span class="op">(</span> cytometer <span class="op">=</span> <span class="st">"aurora"</span>, figures <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="co"># optional: turn on parallel processing</span></span>
<span><span class="va">asp</span><span class="op">$</span><span class="va">parallel</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="co"># where are the single-stained controls?</span></span>
<span><span class="va">control.dir</span> <span class="op">&lt;-</span> <span class="st">"./SSC"</span></span>
<span></span>
<span><span class="co"># create an initial file detailing the controls</span></span>
<span><span class="co"># this requires manual editing</span></span>
<span><span class="fu"><a href="../reference/create.control.file.html">create.control.file</a></span><span class="op">(</span> <span class="va">control.dir</span>, <span class="va">asp</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># splenocyte controls for everything</span></span>
<span><span class="va">control.file.cells</span> <span class="op">&lt;-</span> <span class="st">"fcs_control_file_cells.csv"</span></span>
<span></span>
<span><span class="co"># For this set, we need to expand the large gate parameters</span></span>
<span><span class="co"># more on this in the gating article</span></span>
<span><span class="va">asp</span><span class="op">$</span><span class="va">large.gate.scaling.x</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">asp</span><span class="op">$</span><span class="va">large.gate.scaling.y</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">flow.control.cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define.flow.control.html">define.flow.control</a></span><span class="op">(</span> <span class="va">control.dir</span>, <span class="va">control.file.cells</span>, <span class="va">asp</span> <span class="op">)</span></span></code></pre></div>
<p><img src="figures/Cleaning_cells_nonViability_smallGate.jpg" alt="Standard gate"><img src="figures/Cleaning_cells_nonViability_largeGate.jpg" alt="Large gate"></p>
<p>We can get the fluorophore spectra using only the Robust Linear
Modelling approach (no cleaning). This is slow since it calculates over
all the gated data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spectra.cells.rlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.fluorophore.spectra.html">get.fluorophore.spectra</a></span><span class="op">(</span> <span class="va">flow.control.cells</span>, <span class="va">asp</span>, </span>
<span>                                              title <span class="op">=</span> <span class="st">"Cells RLM"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="figures/Cleaning_RLM_spectral_heatmap.jpg" alt="Cell RLM spectra"> See those horizontal line? That’s the
autofluorescence “dirt” in the controls. An autofluorescence spectrum is
across the bottom and there’s some similarity.</p>
<p><img src="figures/Cleaning_RLM_cosine_similarity.jpg" alt="Cell RLM spectra"> Keep an eye on that mixing matrix condition
number as we progress through the cleaning steps. The condition number
more or less tells you how much trouble you’ll have unmixing the data
(lower is better).</p>
<p>It’s recommended to at least do the first cleaning step: setting
universal negatives. This restricts the calculations to the brightest
events plus scatter-matched negative events from the universal negative.
This speeds things up considerably.</p>
<p>Note that when you call <code>clean.controls</code>, it outputs a
copy of your <code>flow.control</code> structure with a new set of data
that is just the “clean” events. It still has the original “dirty” data.
This means you can overwrite the <code>flow.control</code> if you want,
which reduces memory usage.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean.control.cells.neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean.controls.html">clean.controls</a></span><span class="op">(</span> <span class="va">flow.control.cells</span>, <span class="va">asp</span>, </span>
<span>                                           universal.negative <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="co"># or:</span></span>
<span><span class="co"># flow.control.cells &lt;- clean.controls( flow.control.cells, asp, </span></span>
<span><span class="co">#                                           universal.negative = TRUE )</span></span></code></pre></div>
<p>See folder figure_scatter and figure_spectral_ribbon for plots.</p>
<p>Selected CD64-positive events (macrophages) and matching negative
region: <img src="figures/Cleaning_CD64_APC750_scatter.jpg" alt="Cell RLM spectra"> The same for CD8 (T cells): <img src="figures/Cleaning_CD8_SparkUV387_scatter.jpg" alt="Cell RLM spectra"></p>
<p>It isn’t always easy to see the impact of this, but if we look at the
cells with a higher average level of autofluoresence, like myeloid
cells, we can usually spot it. In the spectral ribbon plot below we’ve
got the distribution of signals for the selected negative events (top
row), brightest positive events (middle) and the bottom row is the
difference between the two (background-subtracted). In this case, it’s
CD11b and the brightest tend to be neutrophils. You can see how the
middle violet area is up in the top and middle rows and that this mostly
gets cancelled out in the bottom row.</p>
<p>Note that we’re displaying all the data here. On the Cytek Aurora,
there’s some sort of cut-off in SpectroFlo software so you don’t see the
low frequency tails of the distributions. This makes it look like the
data is better than it actually is.</p>
<div class="float">
<img src="figures/CD11b_RB744_spectral_ribbon.jpg" alt="Cell RLM spectra"><div class="figcaption">Cell RLM spectra</div>
</div>
<p>We can now extract the spectra again, using the cleaned data
(<code>use.clean.expr = TRUE</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spectra.cells.neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.fluorophore.spectra.html">get.fluorophore.spectra</a></span><span class="op">(</span> <span class="va">clean.control.cells.neg</span>, <span class="va">asp</span>, </span>
<span>                                              use.clean.expr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                              title <span class="op">=</span> <span class="st">"Cells Matching Negative"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="figures/Cleaning_matching_negative_heatmap.jpg" alt="Cell RLM spectra"> Did this help? Yes, there are a couple of
fluorophores that are now not just streaks of yellow across the
board.</p>
<p>To see what’s changed, we can subtract the cleaned spectra from the
original RLM spectra.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta.cells.rlm.neg</span> <span class="op">&lt;-</span> <span class="va">spectra.cells.rlm</span> <span class="op">-</span> <span class="va">spectra.cells.neg</span></span></code></pre></div>
<p>We can create a heatmap (see Plotting article) to visualize this
(this function still needs some work, sorry).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create.heatmap.html">create.heatmap</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span> <span class="va">delta.cells.rlm.neg</span> <span class="op">)</span>, </span>
<span>                legend.label <span class="op">=</span> <span class="st">"Change in spectra"</span>,</span>
<span>                title <span class="op">=</span> <span class="st">"Matched negative change cells"</span>,</span>
<span>                output.dir <span class="op">=</span> <span class="st">"./figure_spectral_change"</span> <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/Cleaning_matched_negatives_heatmap.jpg" alt="Spectral changes"><div class="figcaption">Spectral changes</div>
</div>
<p>The other recommended cleaning step that is recommended is to use
<code>af.remove</code> to exclude intrusive autofluorescent events from
the spectral calculations. We’ll use the scatter-matching negatives and
brightest event selection as well.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean.control.cells.af</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean.controls.html">clean.controls</a></span><span class="op">(</span> <span class="va">flow.control.cells</span>, <span class="va">asp</span>, </span>
<span>                                          universal.negative <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          af.remove <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></span></code></pre></div>
<p>See figure_clean_controls for plots.</p>
<p>The Siglec F BUV615 single-stained control is a nice example here.
This marker is present on eosinophils, a little bit on mast cells and on
alveolar macrophages, none of which is present to any great extent in
C57BL/6J mouse spleens under SPF conditions. There is, however, quite a
bit of noisy autofluorescence in that part of the spectrum.</p>
<p>Here’s the matching unstained sample, which we use to define the gate
around the region of intrusive autofluorescence noise. This gate is
drawn on one of the high AF channels (V7-A in this case) versus the
expected peak for the fluorophore (UV10-A in the case of BUV615 on the
Aurora).</p>
<p><img src="figures/AF_removal_BUV615_negative.jpg" alt="BUV615 negative"> We then copy this gate to the BUV615
single-stained control. Notice how the intrusive AF events are in the
same place, but we now have a (very small bit of) signal in the UV10-A
channel that wasn’t there before. That’s the very few, dim cells we’re
trying to use to define the BUV615 signature. This signal would be
completely overwhelmed by the AF noise, and if you look at the spectral
heatmaps up above you’ll see that the BUV615 line is quite yellow with a
large signal in V7. Making sense now?</p>
<p>Of course, a good solution might be to use compensation beads for
controls like this. BUV615, unfortunately, is one of those dyes that
doesn’t do so well with beads.</p>
<div class="float">
<img src="figures/AF_removal_BUV615.jpg" alt="BUV615 control"><div class="figcaption">BUV615 control</div>
</div>
<p>We also get spectral ribbon plots, this time to show us what the data
look like with and without the removal process in place. You’ll want to
check these because they’ll help you appreciate what’s going on.</p>
<div class="float">
<img src="figures/AF_removal_BUV615_spectral_ribbon_plot.jpg" alt="BUV615 control"><div class="figcaption">BUV615 control</div>
</div>
<p>This is one of the parts I really like. We get the original data
across the top, which is honestly just a bunch of noise. With the
cleaned data in the middle, though, we can start to pick out the two
expected peaks for BUV615: middle UV (UV10) and narrow YG (YG3). It’s
just a hint, but it’s there. And across the bottom, the junk we’re
excluding, which is basically a bunch of macrophages getting in the
way.</p>
<p>We can now extract the spectra using the cleaned data without AF
events.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spectra.cells.af</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.fluorophore.spectra.html">get.fluorophore.spectra</a></span><span class="op">(</span> <span class="va">clean.control.cells.af</span>, <span class="va">asp</span>,</span>
<span>                                             use.clean.expr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                             title <span class="op">=</span> <span class="st">"Cells AF Removed"</span> <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/Cleaning_Cells_AF_Removed_heatmap.jpg" alt="Cell AF Removal spectra"><div class="figcaption">Cell AF Removal spectra</div>
</div>
<p><img src="figures/Cells_AF_removed_similarity.jpg" alt="Spectral changes"> Remember where we started with the condition
number? It was over 80. Same panel, same controls, different result.</p>
<p>What has changed with this cleaning procedure?</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta.cells.rlm.af</span> <span class="op">&lt;-</span> <span class="va">spectra.cells.rlm</span> <span class="op">-</span> <span class="va">spectra.cells.af</span></span>
<span><span class="fu"><a href="../reference/create.heatmap.html">create.heatmap</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span> <span class="va">delta.cells.rlm.af</span> <span class="op">)</span>, </span>
<span>                legend.label <span class="op">=</span> <span class="st">"Change in spectra"</span>,</span>
<span>                title <span class="op">=</span> <span class="st">"AF removal change cells"</span>,</span>
<span>                output.dir <span class="op">=</span> <span class="st">"./figure_spectral_change"</span> <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/AF_removal_change_heatmap.jpg" alt="Spectral changes"><div class="figcaption">Spectral changes</div>
</div>
<p>A value of 0.5 corresponds to 50% peak emission, in other words, a
massive change.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Oliver Burton, Adrian Liston.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
